"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.hasPlugin = hasPlugin;
exports.getPluginOption = getPluginOption;
exports.validatePlugins = validatePlugins;
exports.mixinPluginNames = exports.mixinPlugins = void 0;

var _estree = _interopRequireDefault(require("./plugins/estree"));

var _live = _interopRequireDefault(require("./plugins/live"));

var _flow = _interopRequireDefault(require("./plugins/flow"));

var _jsx = _interopRequireDefault(require("./plugins/jsx"));

var _typescript = _interopRequireDefault(require("./plugins/typescript"));

var _placeholders = _interopRequireDefault(require("./plugins/placeholders"));

var _v8intrinsic = _interopRequireDefault(require("./plugins/v8intrinsic"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function hasPlugin(plugins, name) {
  return plugins.some(function (plugin) {
    if (Array.isArray(plugin)) {
      return plugin[0] === name;
    } else {
      return plugin === name;
    }
  });
}

function getPluginOption(plugins, name, option) {
  var plugin = plugins.find(function (plugin) {
    if (Array.isArray(plugin)) {
      return plugin[0] === name;
    } else {
      return plugin === name;
    }
  });

  if (plugin && Array.isArray(plugin)) {
    return plugin[1][option];
  }

  return null;
}

var PIPELINE_PROPOSALS = ["minimal", "smart", "fsharp"];
var RECORD_AND_TUPLE_SYNTAX_TYPES = ["hash", "bar"];

function validatePlugins(plugins) {
  if (hasPlugin(plugins, "decorators")) {
    if (hasPlugin(plugins, "decorators-legacy")) {
      throw new Error("Cannot use the decorators and decorators-legacy plugin together");
    }

    var decoratorsBeforeExport = getPluginOption(plugins, "decorators", "decoratorsBeforeExport");

    if (decoratorsBeforeExport == null) {
      throw new Error("The 'decorators' plugin requires a 'decoratorsBeforeExport' option," + " whose value must be a boolean. If you are migrating from" + " Babylon/Babel 6 or want to use the old decorators proposal, you" + " should use the 'decorators-legacy' plugin instead of 'decorators'.");
    } else if (typeof decoratorsBeforeExport !== "boolean") {
      throw new Error("'decoratorsBeforeExport' must be a boolean.");
    }
  }

  if (hasPlugin(plugins, "flow") && hasPlugin(plugins, "typescript")) {
    throw new Error("Cannot combine flow and typescript plugins.");
  }

  if (hasPlugin(plugins, "placeholders") && hasPlugin(plugins, "v8intrinsic")) {
    throw new Error("Cannot combine placeholders and v8intrinsic plugins.");
  }

  if (hasPlugin(plugins, "pipelineOperator") && !PIPELINE_PROPOSALS.includes(getPluginOption(plugins, "pipelineOperator", "proposal"))) {
    throw new Error("'pipelineOperator' requires 'proposal' option whose value should be one of: " + PIPELINE_PROPOSALS.map(function (p) {
      return "'".concat(p, "'");
    }).join(", "));
  }

  if (hasPlugin(plugins, "moduleAttributes")) {
    if (process.env.BABEL_8_BREAKING) {
      throw new Error("`moduleAttributes` has been removed in Babel 8, please use `importAssertions` parser plugin, or `@babel/plugin-syntax-import-assertions`.");
    } else {
      if (hasPlugin(plugins, "importAssertions")) {
        throw new Error("Cannot combine importAssertions and moduleAttributes plugins.");
      }

      var moduleAttributesVerionPluginOption = getPluginOption(plugins, "moduleAttributes", "version");

      if (moduleAttributesVerionPluginOption !== "may-2020") {
        throw new Error("The 'moduleAttributes' plugin requires a 'version' option," + " representing the last proposal update. Currently, the" + " only supported value is 'may-2020'.");
      }
    }
  }

  if (hasPlugin(plugins, "recordAndTuple") && !RECORD_AND_TUPLE_SYNTAX_TYPES.includes(getPluginOption(plugins, "recordAndTuple", "syntaxType"))) {
    throw new Error("'recordAndTuple' requires 'syntaxType' option whose value should be one of: " + RECORD_AND_TUPLE_SYNTAX_TYPES.map(function (p) {
      return "'".concat(p, "'");
    }).join(", "));
  }

  if (hasPlugin(plugins, "asyncDoExpressions") && !hasPlugin(plugins, "doExpressions")) {
    var error = new Error("'asyncDoExpressions' requires 'doExpressions', please add 'doExpressions' to parser plugins."); // $FlowIgnore

    error.missingPlugins = "doExpressions"; // so @babel/core can provide better error message

    throw error;
  }
} // These plugins are defined using a mixin which extends the parser class.


// NOTE: order is important. estree must come first; placeholders must come last.
var mixinPlugins = {
  estree: _estree["default"],
  jsx: _jsx["default"],
  flow: _flow["default"],
  typescript: _typescript["default"],
  live: _live["default"],
  v8intrinsic: _v8intrinsic["default"],
  placeholders: _placeholders["default"]
};
exports.mixinPlugins = mixinPlugins;
var mixinPluginNames = Object.keys(mixinPlugins);
exports.mixinPluginNames = mixinPluginNames;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9wbHVnaW4tdXRpbHMuanMiXSwibmFtZXMiOlsiaGFzUGx1Z2luIiwicGx1Z2lucyIsIm5hbWUiLCJzb21lIiwicGx1Z2luIiwiQXJyYXkiLCJpc0FycmF5IiwiZ2V0UGx1Z2luT3B0aW9uIiwib3B0aW9uIiwiZmluZCIsIlBJUEVMSU5FX1BST1BPU0FMUyIsIlJFQ09SRF9BTkRfVFVQTEVfU1lOVEFYX1RZUEVTIiwidmFsaWRhdGVQbHVnaW5zIiwiRXJyb3IiLCJkZWNvcmF0b3JzQmVmb3JlRXhwb3J0IiwiaW5jbHVkZXMiLCJtYXAiLCJwIiwiam9pbiIsInByb2Nlc3MiLCJlbnYiLCJCQUJFTF84X0JSRUFLSU5HIiwibW9kdWxlQXR0cmlidXRlc1ZlcmlvblBsdWdpbk9wdGlvbiIsImVycm9yIiwibWlzc2luZ1BsdWdpbnMiLCJtaXhpblBsdWdpbnMiLCJlc3RyZWUiLCJqc3giLCJmbG93IiwidHlwZXNjcmlwdCIsImxpdmUiLCJ2OGludHJpbnNpYyIsInBsYWNlaG9sZGVycyIsIm1peGluUGx1Z2luTmFtZXMiLCJPYmplY3QiLCJrZXlzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBNklBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBeklPLFNBQVNBLFNBQVQsQ0FBbUJDLE9BQW5CLEVBQXdDQyxJQUF4QyxFQUErRDtBQUNwRSxTQUFPRCxPQUFPLENBQUNFLElBQVIsQ0FBYSxVQUFBQyxNQUFNLEVBQUk7QUFDNUIsUUFBSUMsS0FBSyxDQUFDQyxPQUFOLENBQWNGLE1BQWQsQ0FBSixFQUEyQjtBQUN6QixhQUFPQSxNQUFNLENBQUMsQ0FBRCxDQUFOLEtBQWNGLElBQXJCO0FBQ0QsS0FGRCxNQUVPO0FBQ0wsYUFBT0UsTUFBTSxLQUFLRixJQUFsQjtBQUNEO0FBQ0YsR0FOTSxDQUFQO0FBT0Q7O0FBRU0sU0FBU0ssZUFBVCxDQUNMTixPQURLLEVBRUxDLElBRkssRUFHTE0sTUFISyxFQUlMO0FBQ0EsTUFBTUos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Ly8gQGZsb3dcblxuaW1wb3J0IHR5cGUgUGFyc2VyIGZyb20gXCIuL3BhcnNlclwiO1xuXG5leHBvcnQgdHlwZSBQbHVnaW4gPSBzdHJpbmcgfCBbc3RyaW5nLCBPYmplY3RdO1xuXG5leHBvcnQgdHlwZSBQbHVnaW5MaXN0ID0gJFJlYWRPbmx5QXJyYXk8UGx1Z2luPjtcblxuZXhwb3J0IHR5cGUgTWl4aW5QbHVnaW4gPSAoc3VwZXJDbGFzczogQ2xhc3M8UGFyc2VyPikgPT4gQ2xhc3M8UGFyc2VyPjtcblxuZXhwb3J0IGZ1bmN0aW9uIGhhc1BsdWdpbihwbHVnaW5zOiBQbHVnaW5MaXN0LCBuYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIHBsdWdpbnMuc29tZShwbHVnaW4gPT4ge1xuICAgIGlmIChBcnJheS5pc0FycmF5KHBsdWdpbikpIHtcbiAgICAgIHJldHVybiBwbHVnaW5bMF0gPT09IG5hbWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBwbHVnaW4gPT09IG5hbWU7XG4gICAgfVxuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFBsdWdpbk9wdGlvbihcbiAgcGx1Z2luczogUGx1Z2luTGlzdCxcbiAgbmFtZTogc3RyaW5nLFxuICBvcHRpb246IHN0cmluZyxcbikge1xuICBjb25zdCBwbHVnaW4gPSBwbHVnaW5zLmZpbmQocGx1Z2luID0+IHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShwbHVnaW4pKSB7XG4gICAgICByZXR1cm4gcGx1Z2luWzBdID09PSBuYW1lO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcGx1Z2luID09PSBuYW1lO1xuICAgIH1cbiAgfSk7XG5cbiAgaWYgKHBsdWdpbiAmJiBBcnJheS5pc0FycmF5KHBsdWdpbikpIHtcbiAgICByZXR1cm4gcGx1Z2luWzFdW29wdGlvbl07XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cblxuY29uc3QgUElQRUxJTkVfUFJPUE9TQUxTID0gW1wibWluaW1hbFwiLCBcInNtYXJ0XCIsIFwiZnNoYXJwXCJdO1xuY29uc3QgUkVDT1JEX0FORF9UVVBMRV9TWU5UQVhfVFlQRVMgPSBbXCJoYXNoXCIsIFwiYmFyXCJdO1xuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQbHVnaW5zKHBsdWdpbnM6IFBsdWdpbkxpc3QpIHtcbiAgaWYgKGhhc1BsdWdpbihwbHVnaW5zLCBcImRlY29yYXRvcnNcIikpIHtcbiAgICBpZiAoaGFzUGx1Z2luKHBsdWdpbnMsIFwiZGVjb3JhdG9ycy1sZWdhY3lcIikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJDYW5ub3QgdXNlIHRoZSBkZWNvcmF0b3JzIGFuZCBkZWNvcmF0b3JzLWxlZ2FjeSBwbHVnaW4gdG9nZXRoZXJcIixcbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgZGVjb3JhdG9yc0JlZm9yZUV4cG9ydCA9IGdldFBsdWdpbk9wdGlvbihcbiAgICAgIHBsdWdpbnMsXG4gICAgICBcImRlY29yYXRvcnNcIixcbiAgICAgIFwiZGVjb3JhdG9yc0JlZm9yZUV4cG9ydFwiLFxuICAgICk7XG4gICAgaWYgKGRlY29yYXRvcnNCZWZvcmVFeHBvcnQgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIlRoZSAnZGVjb3JhdG9ycycgcGx1Z2luIHJlcXVpcmVzIGEgJ2RlY29yYXRvcnNCZWZvcmVFeHBvcnQnIG9wdGlvbixcIiArXG4gICAgICAgICAgXCIgd2hvc2UgdmFsdWUgbXVzdCBiZSBhIGJvb2xlYW4uIElmIHlvdSBhcmUgbWlncmF0aW5nIGZyb21cIiArXG4gICAgICAgICAgXCIgQmFieWxvbi9CYWJlbCA2IG9yIHdhbnQgdG8gdXNlIHRoZSBvbGQgZGVjb3JhdG9ycyBwcm9wb3NhbCwgeW91XCIgK1xuICAgICAgICAgIFwiIHNob3VsZCB1c2UgdGhlICdkZWNvcmF0b3JzLWxlZ2FjeScgcGx1Z2luIGluc3RlYWQgb2YgJ2RlY29yYXRvcnMnLlwiLFxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkZWNvcmF0b3JzQmVmb3JlRXhwb3J0ICE9PSBcImJvb2xlYW5cIikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJ2RlY29yYXRvcnNCZWZvcmVFeHBvcnQnIG11c3QgYmUgYSBib29sZWFuLlwiKTtcbiAgICB9XG4gIH1cblxuICBpZiAoaGFzUGx1Z2luKHBsdWdpbnMsIFwiZmxvd1wiKSAmJiBoYXNQbHVnaW4ocGx1Z2lucywgXCJ0eXBlc2NyaXB0XCIpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGNvbWJpbmUgZmxvdyBhbmQgdHlwZXNjcmlwdCBwbHVnaW5zLlwiKTtcbiAgfVxuXG4gIGlmIChoYXNQbHVnaW4ocGx1Z2lucywgXCJwbGFjZWhvbGRlcnNcIikgJiYgaGFzUGx1Z2luKHBsdWdpbnMsIFwidjhpbnRyaW5zaWNcIikpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgY29tYmluZSBwbGFjZWhvbGRlcnMgYW5kIHY4aW50cmluc2ljIHBsdWdpbnMuXCIpO1xuICB9XG5cbiAgaWYgKFxuICAgIGhhc1BsdWdpbihwbHVnaW5zLCBcInBpcGVsaW5lT3BlcmF0b3JcIikgJiZcbiAgICAhUElQRUxJTkVfUFJPUE9TQUxTLmluY2x1ZGVzKFxuICAgICAgZ2V0UGx1Z2luT3B0aW9uKHBsdWdpbnMsIFwicGlwZWxpbmVPcGVyYXRvclwiLCBcInByb3Bvc2FsXCIpLFxuICAgIClcbiAgKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgXCIncGlwZWxpbmVPcGVyYXRvcicgcmVxdWlyZXMgJ3Byb3Bvc2FsJyBvcHRpb24gd2hvc2UgdmFsdWUgc2hvdWxkIGJlIG9uZSBvZjogXCIgK1xuICAgICAgICBQSVBFTElORV9QUk9QT1NBTFMubWFwKHAgPT4gYCcke3B9J2ApLmpvaW4oXCIsIFwiKSxcbiAgICApO1xuICB9XG5cbiAgaWYgKGhhc1BsdWdpbihwbHVnaW5zLCBcIm1vZHVsZUF0dHJpYnV0ZXNcIikpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuQkFCRUxfOF9CUkVBS0lORykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcImBtb2R1bGVBdHRyaWJ1dGVzYCBoYXMgYmVlbiByZW1vdmVkIGluIEJhYmVsIDgsIHBsZWFzZSB1c2UgYGltcG9ydEFzc2VydGlvbnNgIHBhcnNlciBwbHVnaW4sIG9yIGBAYmFiZWwvcGx1Z2luLXN5bnRheC1pbXBvcnQtYXNzZXJ0aW9uc2AuXCIsXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoaGFzUGx1Z2luKHBsdWdpbnMsIFwiaW1wb3J0QXNzZXJ0aW9uc1wiKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgXCJDYW5ub3QgY29tYmluZSBpbXBvcnRBc3NlcnRpb25zIGFuZCBtb2R1bGVBdHRyaWJ1dGVzIHBsdWdpbnMuXCIsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBjb25zdCBtb2R1bGVBdHRyaWJ1dGVzVmVyaW9uUGx1Z2luT3B0aW9uID0gZ2V0UGx1Z2luT3B0aW9uKFxuICAgICAgICBwbHVnaW5zLFxuICAgICAgICBcIm1vZHVsZUF0dHJpYnV0ZXNcIixcbiAgICAgICAgXCJ2ZXJzaW9uXCIsXG4gICAgICApO1xuICAgICAgaWYgKG1vZHVsZUF0dHJpYnV0ZXNWZXJpb25QbHVnaW5PcHRpb24gIT09IFwibWF5LTIwMjBcIikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgXCJUaGUgJ21vZHVsZUF0dHJpYnV0ZXMnIHBsdWdpbiByZXF1aXJlcyBhICd2ZXJzaW9uJyBvcHRpb24sXCIgK1xuICAgICAgICAgICAgXCIgcmVwcmVzZW50aW5nIHRoZSBsYXN0IHByb3Bvc2FsIHVwZGF0ZS4gQ3VycmVudGx5LCB0aGVcIiArXG4gICAgICAgICAgICBcIiBvbmx5IHN1cHBvcnRlZCB2YWx1ZSBpcyAnbWF5LTIwMjAnLlwiLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChcbiAgICBoYXNQbHVnaW4ocGx1Z2lucywgXCJyZWNvcmRBbmRUdXBsZVwiKSAmJlxuICAgICFSRUNPUkRfQU5EX1RVUExFX1NZTlRBWF9UWVBFUy5pbmNsdWRlcyhcbiAgICAgIGdldFBsdWdpbk9wdGlvbihwbHVnaW5zLCBcInJlY29yZEFuZFR1cGxlXCIsIFwic3ludGF4VHlwZVwiKSxcbiAgICApXG4gICkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIFwiJ3JlY29yZEFuZFR1cGxlJyByZXF1aXJlcyAnc3ludGF4VHlwZScgb3B0aW9uIHdob3NlIHZhbHVlIHNob3VsZCBiZSBvbmUgb2Y6IFwiICtcbiAgICAgICAgUkVDT1JEX0FORF9UVVBMRV9TWU5UQVhfVFlQRVMubWFwKHAgPT4gYCcke3B9J2ApLmpvaW4oXCIsIFwiKSxcbiAgICApO1xuICB9XG5cbiAgaWYgKFxuICAgIGhhc1BsdWdpbihwbHVnaW5zLCBcImFzeW5jRG9FeHByZXNzaW9uc1wiKSAmJlxuICAgICFoYXNQbHVnaW4ocGx1Z2lucywgXCJkb0V4cHJlc3Npb25zXCIpXG4gICkge1xuICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFxuICAgICAgXCInYXN5bmNEb0V4cHJlc3Npb25zJyByZXF1aXJlcyAnZG9FeHByZXNzaW9ucycsIHBsZWFzZSBhZGQgJ2RvRXhwcmVzc2lvbnMnIHRvIHBhcnNlciBwbHVnaW5zLlwiLFxuICAgICk7XG4gICAgLy8gJEZsb3dJZ25vcmVcbiAgICBlcnJvci5taXNzaW5nUGx1Z2lucyA9IFwiZG9FeHByZXNzaW9uc1wiOyAvLyBzbyBAYmFiZWwvY29yZSBjYW4gcHJvdmlkZSBiZXR0ZXIgZXJyb3IgbWVzc2FnZVxuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8vIFRoZXNlIHBsdWdpbnMgYXJlIGRlZmluZWQgdXNpbmcgYSBtaXhpbiB3aGljaCBleHRlbmRzIHRoZSBwYXJzZXIgY2xhc3MuXG5cbmltcG9ydCBlc3RyZWUgZnJvbSBcIi4vcGx1Z2lucy9lc3RyZWVcIjtcbmltcG9ydCBsaXZlIGZyb20gXCIuL3BsdWdpbnMvbGl2ZVwiO1xuaW1wb3J0IGZsb3cgZnJvbSBcIi4vcGx1Z2lucy9mbG93XCI7XG5pbXBvcnQganN4IGZyb20gXCIuL3BsdWdpbnMvanN4XCI7XG5pbXBvcnQgdHlwZXNjcmlwdCBmcm9tIFwiLi9wbHVnaW5zL3R5cGVzY3JpcHRcIjtcbmltcG9ydCBwbGFjZWhvbGRlcnMgZnJvbSBcIi4vcGx1Z2lucy9wbGFjZWhvbGRlcnNcIjtcbmltcG9ydCB2OGludHJpbnNpYyBmcm9tIFwiLi9wbHVnaW5zL3Y4aW50cmluc2ljXCI7XG5cbi8vIE5PVEU6IG9yZGVyIGlzIGltcG9ydGFudC4gZXN0cmVlIG11c3QgY29tZSBmaXJzdDsgcGxhY2Vob2xkZXJzIG11c3QgY29tZSBsYXN0LlxuZXhwb3J0IGNvbnN0IG1peGluUGx1Z2luczogeyBbbmFtZTogc3RyaW5nXTogTWl4aW5QbHVnaW4gfSA9IHtcbiAgZXN0cmVlLFxuICBqc3gsXG4gIGZsb3csXG4gIHR5cGVzY3JpcHQsXG4gIGxpdmUsXG4gIHY4aW50cmluc2ljLFxuICBwbGFjZWhvbGRlcnMsXG59O1xuXG5leHBvcnQgY29uc3QgbWl4aW5QbHVnaW5OYW1lczogJFJlYWRPbmx5QXJyYXk8c3RyaW5nPiA9XG4gIE9iamVjdC5rZXlzKG1peGluUGx1Z2lucyk7XG4iXX0=